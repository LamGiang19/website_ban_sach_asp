@{
    ViewData["Title"] = "Trang chủ - Vua Sách Cũ";
}

<!-- Banner Section -->
<section class="banner-section mb-4">
    <div class="container-fluid px-0">
        <div class="promo-banner">
            <div class="banner-content-wrapper">
                <div class="banner-left">
                    <div class="book-stack">
                        <div class="book-item">
                            <div class="book-cover">📚</div>
                            <div class="big-sale-badge">BIG SALE</div>
                        </div>
                    </div>
                </div>
                <div class="banner-right">
                    <div class="promo-text">
                        <h1 class="promo-title">SÁCH ĐỒNG GIÁ 9K</h1>
                        <p class="promo-subtitle">Khuyến mãi đặc biệt</p>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>

<!-- Sách Bán Chạy -->
<section class="product-section mb-5">
    <div class="section-header bg-orange text-white p-3 mb-3">
        <div class="container-fluid">
            <div class="d-flex justify-content-between align-items-center">
                <h2 class="section-title mb-0">
                    <i class="fas fa-fire"></i> SÁCH BÁN CHẠY
                </h2>
                <a href="#" class="text-white text-decoration-none">Xem tất cả <i class="fas fa-arrow-right"></i></a>
            </div>
        </div>
    </div>
    <div class="container-fluid">
        <div class="product-scroll-wrapper">
            <div class="product-scroll">
                @if (ViewBag.SachBanChay != null)
                {
                    @foreach (var sach in (List<WebBanSachLg.Database.Sach>)ViewBag.SachBanChay)
                    {
                        <div class="product-card-item">
                            @await Html.PartialAsync("_SachCard", sach)
                        </div>
                    }
                }
            </div>
        </div>
    </div>
</section>

<!-- Truyện Trinh Thám -->
<section class="product-section mb-5">
    <div class="section-header bg-orange text-white p-3 mb-3">
        <div class="container-fluid">
            <div class="d-flex justify-content-between align-items-center">
                <h2 class="section-title mb-0">
                    <i class="fas fa-search"></i> TRUYỆN TRINH THÁM
                </h2>
                <a href="#" class="text-white text-decoration-none">Tất cả <i class="fas fa-arrow-right"></i></a>
            </div>
        </div>
    </div>
    <div class="container-fluid">
        <div class="row">
            <div class="col-md-3">
                <div class="sidebar-books">
                    @if (ViewBag.SachBanChay != null)
                    {
                        @foreach (var sach in ((List<WebBanSachLg.Database.Sach>)ViewBag.SachBanChay).Take(4))
                        {
                            <div class="sidebar-book-item">
                                <img src="@(sach.HinhAnh ?? "/images/sach/default.jpg")" alt="@sach.TenSach" onerror="this.src='/images/sach/default.jpg'">
                                <div class="sidebar-book-info">
                                    <h6>@sach.TenSach</h6>
                                    <div class="price">
                                        <span class="current-price">9,000₫</span>
                                        <span class="old-price">55,000₫</span>
                                    </div>
                                </div>
                            </div>
                        }
                    }
                </div>
            </div>
            <div class="col-md-9">
                <div class="product-scroll-wrapper">
                    <div class="product-scroll">
                        @if (ViewBag.SachTieuThuyet != null)
                        {
                            @foreach (var sach in (List<WebBanSachLg.Database.Sach>)ViewBag.SachTieuThuyet)
                            {
                                <div class="product-card-item">
                                    @await Html.PartialAsync("_SachCard", sach)
                                </div>
                            }
                        }
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>

<!-- Sách Tiểu Thuyết -->
<section class="product-section mb-5">
    <div class="section-header bg-orange text-white p-3 mb-3">
        <div class="container-fluid">
            <div class="d-flex justify-content-between align-items-center">
                <h2 class="section-title mb-0">SÁCH TIỂU THUYẾT</h2>
                <a href="#" class="text-white text-decoration-none">Xem tất cả <i class="fas fa-arrow-right"></i></a>
            </div>
        </div>
    </div>
    <div class="container-fluid">
        <div class="product-scroll-wrapper">
            <div class="product-scroll">
                @if (ViewBag.SachTieuThuyet != null)
                {
                    @foreach (var sach in (List<WebBanSachLg.Database.Sach>)ViewBag.SachTieuThuyet)
                    {
                        <div class="product-card-item">
                            @await Html.PartialAsync("_SachCard", sach)
                        </div>
                    }
                }
            </div>
        </div>
    </div>
</section>

<!-- Sách Khoa Học -->
<section class="product-section mb-5">
    <div class="section-header bg-orange text-white p-3 mb-3">
        <div class="container-fluid">
            <div class="d-flex justify-content-between align-items-center">
                <h2 class="section-title mb-0">SÁCH KHOA HỌC</h2>
                <a href="#" class="text-white text-decoration-none">Xem tất cả <i class="fas fa-arrow-right"></i></a>
            </div>
        </div>
    </div>
    <div class="container-fluid">
        <div class="product-scroll-wrapper">
            <div class="product-scroll">
                @if (ViewBag.SachKhoaHoc != null)
                {
                    @foreach (var sach in (List<WebBanSachLg.Database.Sach>)ViewBag.SachKhoaHoc)
                    {
                        <div class="product-card-item">
                            @await Html.PartialAsync("_SachCard", sach)
                        </div>
                    }
                }
            </div>
        </div>
    </div>
</section>

<!-- Sách Thiếu Nhi -->
<section class="product-section mb-5">
    <div class="section-header bg-orange text-white p-3 mb-3">
        <div class="container-fluid">
            <div class="d-flex justify-content-between align-items-center">
                <h2 class="section-title mb-0">SÁCH THIẾU NHI</h2>
                <a href="#" class="text-white text-decoration-none">Xem tất cả <i class="fas fa-arrow-right"></i></a>
            </div>
        </div>
    </div>
    <div class="container-fluid">
        <div class="product-scroll-wrapper">
            <div class="product-scroll">
                @if (ViewBag.SachThieuNhi != null)
                {
                    @foreach (var sach in (List<WebBanSachLg.Database.Sach>)ViewBag.SachThieuNhi)
                    {
                        <div class="product-card-item">
                            @await Html.PartialAsync("_SachCard", sach)
                        </div>
                    }
                }
            </div>
        </div>
    </div>
</section>

@section Scripts {
    <script>
        // Horizontal scroll cho product sections - chỉ chạy một lần khi DOM ready
        $(document).ready(function() {
            // Kiểm tra và set overflow cho product scroll
            $('.product-scroll').each(function() {
                const $this = $(this);
                // Chỉ set nếu chưa được set
                if (!$this.data('scroll-initialized')) {
                    if (this.scrollWidth > $this.width()) {
                        $this.css('overflow-x', 'auto');
                    }
                    $this.data('scroll-initialized', true);
                }
            });
        });
    </script>
}
